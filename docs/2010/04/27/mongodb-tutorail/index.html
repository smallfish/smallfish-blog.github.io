
<!DOCTYPE html>
<html lang="zh-CN">

    <head>

        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />

        <meta property="og:title" content=" 【译】MongoDB 入门教程 &middot;  smallfish&#39;s blog" />
        <meta property="og:site_name" content="smallfish&#39;s blog" />
        <meta property="og:url" content="http://chenxiaoyu.org/2010/04/27/mongodb-tutorail/" />

    
        <meta property="og:type" content="article" />
        <meta property="og:article:published_time" content="2010-04-27T00:00:00Z" />
        

        <meta name="twitter:card" content="summary" />
        <meta name="twitter:site" content="@" />
        <meta name="twitter:creator" content="@" />
        <meta name="twitter:title" content="【译】MongoDB 入门教程" />
        <meta name="twitter:description" content="" />
        <meta name="twitter:url" content="http://chenxiaoyu.org/2010/04/27/mongodb-tutorail/" />
    

        <title> 【译】MongoDB 入门教程 &middot;  smallfish&#39;s blog</title>

    
        <meta name="description" content="" />
    
        
        <meta name="p:domain_verify" content="fc173d84e3a4de948ed4bda2908afd3e"/>
        <meta name="HandheldFriendly" content="True" />
        <meta name="MobileOptimized" content="320" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />

        
          

    
        <link href="http://chenxiaoyu.org/index.xml" rel="alternate" type="application/rss+xml" title="smallfish&#39;s blog" />
    

    
        <link rel="canonical" href="http://chenxiaoyu.org/2010/04/27/mongodb-tutorail/" />

    
    <script type="application/ld+json">
    { 
        "@context": "http://schema.org",
        "@type": "Article",
        "headline": "【译】MongoDB 入门教程",
        "author": {
            "@type": "Person",
            "name": "http://profiles.google.com/?rel=author"
        },
        "datePublished": "2010-04-27",
        "description": "",
        "wordCount": 1050
    }
    </script>
    
    
    <style>
*{padding:0;margin:0}body,html{font-size:1em;line-height:1.65em;font-family:"Open Sans",sans-serif;font-weight:300;color:#444}html{height:100%}body{padding:2em 2.5em 1em 20em}header{border-right:1px #eee solid;padding:2em;position:fixed;top:0;left:0;height:100%;width:13.5em}#content{display:block;width:100%}footer{padding:1em 0 2.5em;font-size:.8em;line-height:1.5em;color:#888}article{border-bottom:.1em #eee solid;padding-bottom:1.7em;max-width:56em}h4,h5,h6,hr,p{margin-top:.9em;margin-bottom:.9em}h1,h2,h3,h4,h5,h6{font-family:"Bree Serif",serif;font-weight:400!important}h1{font-size:2.5em;line-height:1.1em;margin-top:.6em;margin-bottom:.6em}h2{font-size:1.9em;line-height:1.2em;margin-top:.7em;margin-bottom:.7em}h3{font-size:1.4em;line-height:1.3em;margin-top:.8em;margin-bottom:.8em}h4{font-size:1.3em}h5{font-size:1.2em}h6{font-size:1.1em}iframe,img{max-width:100%}a{font-weight:700;text-decoration:none;color:#5cc265}a:hover{text-decoration:underline}h1 a,h2 a,h3 a,h4 a,h5 a,h6 a{font-weight:400!important}strong{font-weight:700}blockquote{border-left:.4em solid #eee;padding-left:1.2em;font-size:1.3em}hr{border:0;height:1px;background:#eee}ol,ul{margin-left:3em}code{font-size:1.4em;background:#eee}pre{font-size:.8em;line-height:2em;background:#eee;padding:1em;word-break:break-all;word-wrap:break-word;white-space:pre;white-space:-moz-pre-wrap;white-space:pre-wrap}input{font-size:1em;padding:.3em}header h1{font-size:1.9em;margin-top:.8em;margin-bottom:.6em}header h1 a{color:#444}header h1 a:hover{text-decoration:none}header #logo img{width:9em;height:9em;border-radius:4.5em;-moz-border-radius:4.5em;-webkit-border-radius:4.5em;border:none}#follow-icons{font-size:.7em;margin-top:-.7em;margin-bottom:1.5em}#follow-icons a{color:#ccc}#follow-icons span{vertical-align:top;margin-left:-.15em;margin-right:-.15em}#follow-icons span .fa-stack-1x{font-size:1.05em;line-height:1.9em}header h6{margin-top:.5em}article span.post-stamp{color:#888}h1.post-title{margin-top:.35em;margin-bottom:.6em}h3.post-title{margin-top:.4em;padding-bottom:.9em;border-bottom:1px solid #eee;font-size:1.2em;color:#444}.post-title .feature-star{font-size:.9em}.feature-star,.separator,.taglist{color:#ccc}.taglist a{background-color:#ccc;color:#fff;display:inline-block;line-height:1.5em;padding:.3em .6em;vertical-align:20%;font-size:.5em;font-family:"Open Sans",sans-serif;font-weight:700!important;text-transform:uppercase;letter-spacing:.05em;border-radius:.25em;-moz-border-radius:.25em;-webkit-border-radius:.25em}#social-bar{margin-top:1.5em;background-color:#eee;padding:.5em}#comments{margin-top:.15em;padding-bottom:.2em;border-bottom:1px solid #eee}.pagination{margin-bottom:1em}footer a{font-weight:300;color:#888;text-decoration:underline}footer a:hover{color:#444;text-decoration:none}@media only screen and (min-width:1281px){body,html{font-size:1.1em}}@media only screen and (max-width:800px){body{padding:0}header{border-right:none;border-bottom:1px #eee solid;position:relative;height:auto;width:auto;text-align:center;padding-bottom:1em}#content{margin-left:0;padding:2em 2em 1em;width:auto}footer{padding:0 2.5em 2em}}@media only screen and (max-width:320px){#content,header{padding:1.2em 1.2em .6em}footer{padding:0 1.5em 1.2em}ol,ul{margin-left:2em}}
</style>
    </head>
    <body>
        <header id="header">
            <a id="logo" href="http://chenxiaoyu.org/"><img src="https://avatars1.githubusercontent.com/u/105860?v=3&s=460" alt="smallfish&#39;s blog" /></a>
            <h1><a href="http://chenxiaoyu.org/">smallfish&#39;s blog</a></h1>
            <p></p>

            <div id="follow-icons">
	<a href="http://github.com/smallfish" rel="me"><i class="fa fa-github-square fa-2x"></i></a>
	<a href="http://twitter.com/smallfishxy" rel="me"><i class="fa fa-twitter-square fa-2x"></i></a>
	<a href="http://chenxiaoyu.org/index.xml" rel="me"><i class="fa fa-rss-square fa-2x"></i></a> 
</div>  

            Engineer@Alibaba, Alipay

        </header>

<main id="content">

<article id="" class="2010">
    <div class="post-stamp">
        <time datetime="2010-04-27T00:00:00Z">
            27 Apr 2010
        </time>
        <span class="taglist">
        
        </span>
    </div>
    <h1 class="post-title">【译】MongoDB 入门教程</h1>
    <p>原文参见：<a href="http://www.mongodb.org/display/DOCS/Tutorial">http://www.mongodb.org/display/DOCS/Tutorial</a></p>

<p>启动数据库</p>

<p>下载 <a href="http://www.mongodb.org/display/DOCS/Downloads">http://www.mongodb.org/display/DOCS/Downloads</a>, 解压后并启动:</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span></span><span class="err">$</span> <span class="nb">bin</span><span class="o">/</span><span class="n">mongod</span>
</code></pre></div>


<p>MongoDB 默认存储数据目录为 /data/db/ (或者 c:\data\db), 当然你也可以修改成不同目录, 只需要指定 &ndash;dbpath 参数:</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span></span><span class="err">$</span> <span class="nb">bin</span><span class="o">/</span><span class="n">mongod</span> <span class="o">--</span><span class="n">dbpath</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">my</span><span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="nb">dir</span>
</code></pre></div>


<p>获取数据库连接</p>

<p>现在我们就可以使用自带的shell工具来操作数据库了. (我们也可以使用各种编程语言的驱动来使用MongoDB, 自带的shell工具可以方便我们管理数据库)</p>

<p>启动 MongoDB JavaScript 工具:</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span></span><span class="err">$</span> <span class="nb">bin</span><span class="o">/</span><span class="n">mongo</span>
</code></pre></div>


<p>默认 shell 连接的是本机localhost 上面的 test库, 会看到:</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span></span><span class="n">MongoDB</span> <span class="n">shell</span> <span class="n">version</span><span class="p">:</span> <span class="mf">0.9</span><span class="o">.</span><span class="mi">8</span>
<span class="n">url</span><span class="p">:</span> <span class="n">test</span>
<span class="n">connecting</span> <span class="n">to</span><span class="p">:</span> <span class="n">test</span>
<span class="nb">type</span> <span class="s2">&quot;help&quot;</span> <span class="k">for</span> <span class="n">help</span>
<span class="o">&gt;</span>
</code></pre></div>


<p>&ldquo;connecting to:&rdquo; 这个会显示你正在使用的数据库的名称. 想换数据库的话可以:</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span></span><span class="o">&gt;</span> <span class="n">use</span> <span class="n">mydb</span>
</code></pre></div>


<p>可以输入 help 来查看所有的命令.</p>

<p>插入数据到集合</p>

<p>下面我们来建立一个test的集合并写入一些数据. 建立两个对象, j 和 t , 并保存到集合中去.
在例子里  &lsquo;&gt;&rsquo;  来表示是 shell 输入提示符</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span></span><span class="o">&gt;</span> <span class="n">j</span> <span class="o">=</span> <span class="p">{</span> <span class="n">name</span> <span class="p">:</span> <span class="s2">&quot;mongo&quot;</span> <span class="p">};</span>
<span class="p">{</span><span class="s2">&quot;name&quot;</span> <span class="p">:</span> <span class="s2">&quot;mongo&quot;</span><span class="p">}</span>
<span class="o">&gt;</span> <span class="n">t</span> <span class="o">=</span> <span class="p">{</span> <span class="n">x</span> <span class="p">:</span> <span class="mi">3</span> <span class="p">};</span>
<span class="p">{</span> <span class="s2">&quot;x&quot;</span> <span class="p">:</span> <span class="mi">3</span>  <span class="p">}</span>
<span class="o">&gt;</span> <span class="n">db</span><span class="o">.</span><span class="n">things</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
<span class="o">&gt;</span> <span class="n">db</span><span class="o">.</span><span class="n">things</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">t</span><span class="p">);</span>
<span class="o">&gt;</span> <span class="n">db</span><span class="o">.</span><span class="n">things</span><span class="o">.</span><span class="n">find</span><span class="p">();</span>
<span class="p">{</span><span class="s2">&quot;name&quot;</span> <span class="p">:</span> <span class="s2">&quot;mongo&quot;</span> <span class="p">,</span> <span class="s2">&quot;_id&quot;</span> <span class="p">:</span> <span class="n">ObjectId</span><span class="p">(</span><span class="s2">&quot;497cf60751712cf7758fbdbb&quot;</span><span class="p">)}</span>
<span class="p">{</span><span class="s2">&quot;x&quot;</span> <span class="p">:</span> <span class="mi">3</span> <span class="p">,</span> <span class="s2">&quot;_id&quot;</span> <span class="p">:</span> <span class="n">ObjectId</span><span class="p">(</span><span class="s2">&quot;497cf61651712cf7758fbdbc&quot;</span><span class="p">)}</span>
<span class="o">&gt;</span>
</code></pre></div>


<p>有几点需要注意下 :
<ul>
    <li>不需要预先建立一个集合. 在第一次插入数据时候会自动建立.</li>
    <li>在例子其实可以存储任何结构的数据, 当然在实际应用我们存储的还是相同元素的集合. 这个特性其实可以在应用里很灵活, 你不需要类似 alter table 来修改你的数据结构</li>
    <li>每次插入数据时候对象都会有一个ID, 名字叫 _id.</li>
</ul>
当你运行不同的例子, 你的对象ID值都是不同的.</p>

<p>下面再加点数据:</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span></span><span class="o">&gt;</span> <span class="k">for</span><span class="p">(</span> <span class="n">var</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span> <span class="p">)</span> <span class="n">db</span><span class="o">.</span><span class="n">things</span><span class="o">.</span><span class="n">save</span><span class="p">(</span> <span class="p">{</span> <span class="n">x</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span><span class="n">i</span> <span class="p">}</span> <span class="p">);</span> <span class="o">&gt;</span> <span class="n">db</span><span class="o">.</span><span class="n">things</span><span class="o">.</span><span class="n">find</span><span class="p">();</span>
<span class="p">{</span><span class="s2">&quot;name&quot;</span> <span class="p">:</span> <span class="s2">&quot;mongo&quot;</span> <span class="p">,</span> <span class="s2">&quot;_id&quot;</span> <span class="p">:</span> <span class="n">ObjectId</span><span class="p">(</span><span class="s2">&quot;497cf60751712cf7758fbdbb&quot;</span><span class="p">)}</span>
<span class="p">{</span><span class="s2">&quot;x&quot;</span> <span class="p">:</span> <span class="mi">3</span> <span class="p">,</span> <span class="s2">&quot;_id&quot;</span> <span class="p">:</span> <span class="n">ObjectId</span><span class="p">(</span><span class="s2">&quot;497cf61651712cf7758fbdbc&quot;</span><span class="p">)}</span>
<span class="p">{</span><span class="s2">&quot;x&quot;</span> <span class="p">:</span> <span class="mi">4</span> <span class="p">,</span> <span class="s2">&quot;j&quot;</span> <span class="p">:</span> <span class="mi">1</span> <span class="p">,</span> <span class="s2">&quot;_id&quot;</span> <span class="p">:</span> <span class="n">ObjectId</span><span class="p">(</span><span class="s2">&quot;497cf87151712cf7758fbdbd&quot;</span><span class="p">)}</span>
<span class="p">{</span><span class="s2">&quot;x&quot;</span> <span class="p">:</span> <span class="mi">4</span> <span class="p">,</span> <span class="s2">&quot;j&quot;</span> <span class="p">:</span> <span class="mi">2</span> <span class="p">,</span> <span class="s2">&quot;_id&quot;</span> <span class="p">:</span> <span class="n">ObjectId</span><span class="p">(</span><span class="s2">&quot;497cf87151712cf7758fbdbe&quot;</span><span class="p">)}</span>
<span class="p">{</span><span class="s2">&quot;x&quot;</span> <span class="p">:</span> <span class="mi">4</span> <span class="p">,</span> <span class="s2">&quot;j&quot;</span> <span class="p">:</span> <span class="mi">3</span> <span class="p">,</span> <span class="s2">&quot;_id&quot;</span> <span class="p">:</span> <span class="n">ObjectId</span><span class="p">(</span><span class="s2">&quot;497cf87151712cf7758fbdbf&quot;</span><span class="p">)}</span>
<span class="p">{</span><span class="s2">&quot;x&quot;</span> <span class="p">:</span> <span class="mi">4</span> <span class="p">,</span> <span class="s2">&quot;j&quot;</span> <span class="p">:</span> <span class="mi">4</span> <span class="p">,</span> <span class="s2">&quot;_id&quot;</span> <span class="p">:</span> <span class="n">ObjectId</span><span class="p">(</span><span class="s2">&quot;497cf87151712cf7758fbdc0&quot;</span><span class="p">)}</span>
<span class="p">{</span><span class="s2">&quot;x&quot;</span> <span class="p">:</span> <span class="mi">4</span> <span class="p">,</span> <span class="s2">&quot;j&quot;</span> <span class="p">:</span> <span class="mi">5</span> <span class="p">,</span> <span class="s2">&quot;_id&quot;</span> <span class="p">:</span> <span class="n">ObjectId</span><span class="p">(</span><span class="s2">&quot;497cf87151712cf7758fbdc1&quot;</span><span class="p">)}</span>
<span class="p">{</span><span class="s2">&quot;x&quot;</span> <span class="p">:</span> <span class="mi">4</span> <span class="p">,</span> <span class="s2">&quot;j&quot;</span> <span class="p">:</span> <span class="mi">6</span> <span class="p">,</span> <span class="s2">&quot;_id&quot;</span> <span class="p">:</span> <span class="n">ObjectId</span><span class="p">(</span><span class="s2">&quot;497cf87151712cf7758fbdc2&quot;</span><span class="p">)}</span>
<span class="p">{</span><span class="s2">&quot;x&quot;</span> <span class="p">:</span> <span class="mi">4</span> <span class="p">,</span> <span class="s2">&quot;j&quot;</span> <span class="p">:</span> <span class="mi">7</span> <span class="p">,</span> <span class="s2">&quot;_id&quot;</span> <span class="p">:</span> <span class="n">ObjectId</span><span class="p">(</span><span class="s2">&quot;497cf87151712cf7758fbdc3&quot;</span><span class="p">)}</span>
<span class="p">{</span><span class="s2">&quot;x&quot;</span> <span class="p">:</span> <span class="mi">4</span> <span class="p">,</span> <span class="s2">&quot;j&quot;</span> <span class="p">:</span> <span class="mi">8</span> <span class="p">,</span> <span class="s2">&quot;_id&quot;</span> <span class="p">:</span> <span class="n">ObjectId</span><span class="p">(</span><span class="s2">&quot;497cf87151712cf7758fbdc4&quot;</span><span class="p">)}</span>
</code></pre></div>


<p>请注意下, 这里循环次数是10, 但是只显示到8, 还有2条数据没有显示.</p>

<p>如果想继续查询下面的数据只需要使用 it 命令, 就会继续下面的数据:</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span></span><span class="p">{</span><span class="s2">&quot;x&quot;</span> <span class="p">:</span> <span class="mi">4</span> <span class="p">,</span> <span class="s2">&quot;j&quot;</span> <span class="p">:</span> <span class="mi">7</span> <span class="p">,</span> <span class="s2">&quot;_id&quot;</span> <span class="p">:</span> <span class="n">ObjectId</span><span class="p">(</span><span class="s2">&quot;497cf87151712cf7758fbdc3&quot;</span><span class="p">)}</span>
<span class="p">{</span><span class="s2">&quot;x&quot;</span> <span class="p">:</span> <span class="mi">4</span> <span class="p">,</span> <span class="s2">&quot;j&quot;</span> <span class="p">:</span> <span class="mi">8</span> <span class="p">,</span> <span class="s2">&quot;_id&quot;</span> <span class="p">:</span> <span class="n">ObjectId</span><span class="p">(</span><span class="s2">&quot;497cf87151712cf7758fbdc4&quot;</span><span class="p">)}</span>
</code></pre></div>


<p>继续</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span></span><span class="o">&gt;</span> <span class="n">it</span>
<span class="p">{</span><span class="s2">&quot;x&quot;</span> <span class="p">:</span> <span class="mi">4</span> <span class="p">,</span> <span class="s2">&quot;j&quot;</span> <span class="p">:</span> <span class="mi">9</span> <span class="p">,</span> <span class="s2">&quot;_id&quot;</span> <span class="p">:</span> <span class="n">ObjectId</span><span class="p">(</span><span class="s2">&quot;497cf87151712cf7758fbdc5&quot;</span><span class="p">)}</span>
<span class="p">{</span><span class="s2">&quot;x&quot;</span> <span class="p">:</span> <span class="mi">4</span> <span class="p">,</span> <span class="s2">&quot;j&quot;</span> <span class="p">:</span> <span class="mi">10</span> <span class="p">,</span> <span class="s2">&quot;_id&quot;</span> <span class="p">:</span> <span class="n">ObjectId</span><span class="p">(</span><span class="s2">&quot;497cf87151712cf7758fbdc6&quot;</span><span class="p">)}</span>
</code></pre></div>


<p>从技术上讲 find() 返回一个游标对象. 但在上面的例子里, 并没有拿到一个游标的变量. 所以 shell 自动遍历游标, 返回一个初始化的set, 并允许我们继续用 it 迭代输出.</p>

<p>当然我们也可以直接用游标来输出, 不过这个是下一部分的内容了.</p>

<p>查询数据</p>

<p>在没有深入查询之前, 我们先看看怎么从一个查询中返回一个游标对象. 可以简单的通过 find() 来查询, 他返回一个任意结构的集合. 如果实现特定的查询稍后讲解.</p>

<p>实现上面同样的查询, 然后通过 while 来输出:</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span></span><span class="o">&gt;</span> <span class="n">var</span> <span class="n">cursor</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">things</span><span class="o">.</span><span class="n">find</span><span class="p">();</span>
<span class="o">&gt;</span> <span class="k">while</span> <span class="p">(</span><span class="n">cursor</span><span class="o">.</span><span class="n">hasNext</span><span class="p">())</span> <span class="p">{</span> <span class="k">print</span><span class="p">(</span><span class="n">tojson</span><span class="p">(</span><span class="n">cursor</span><span class="o">.</span><span class="n">next</span><span class="p">()));</span> <span class="p">}</span>
<span class="p">{</span><span class="s2">&quot;name&quot;</span> <span class="p">:</span> <span class="s2">&quot;mongo&quot;</span> <span class="p">,</span> <span class="s2">&quot;_id&quot;</span> <span class="p">:</span> <span class="n">ObjectId</span><span class="p">(</span><span class="s2">&quot;497cf60751712cf7758fbdbb&quot;</span><span class="p">)}</span>
<span class="p">{</span><span class="s2">&quot;x&quot;</span> <span class="p">:</span> <span class="mi">3</span> <span class="p">,</span> <span class="s2">&quot;_id&quot;</span> <span class="p">:</span> <span class="n">ObjectId</span><span class="p">(</span><span class="s2">&quot;497cf61651712cf7758fbdbc&quot;</span><span class="p">)}</span>
<span class="p">{</span><span class="s2">&quot;x&quot;</span> <span class="p">:</span> <span class="mi">4</span> <span class="p">,</span> <span class="s2">&quot;j&quot;</span> <span class="p">:</span> <span class="mi">1</span> <span class="p">,</span> <span class="s2">&quot;_id&quot;</span> <span class="p">:</span> <span class="n">ObjectId</span><span class="p">(</span><span class="s2">&quot;497cf87151712cf7758fbdbd&quot;</span><span class="p">)}</span>
<span class="p">{</span><span class="s2">&quot;x&quot;</span> <span class="p">:</span> <span class="mi">4</span> <span class="p">,</span> <span class="s2">&quot;j&quot;</span> <span class="p">:</span> <span class="mi">2</span> <span class="p">,</span> <span class="s2">&quot;_id&quot;</span> <span class="p">:</span> <span class="n">ObjectId</span><span class="p">(</span><span class="s2">&quot;497cf87151712cf7758fbdbe&quot;</span><span class="p">)}</span>
<span class="p">{</span><span class="s2">&quot;x&quot;</span> <span class="p">:</span> <span class="mi">4</span> <span class="p">,</span> <span class="s2">&quot;j&quot;</span> <span class="p">:</span> <span class="mi">3</span> <span class="p">,</span> <span class="s2">&quot;_id&quot;</span> <span class="p">:</span> <span class="n">ObjectId</span><span class="p">(</span><span class="s2">&quot;497cf87151712cf7758fbdbf&quot;</span><span class="p">)}</span>
<span class="p">{</span><span class="s2">&quot;x&quot;</span> <span class="p">:</span> <span class="mi">4</span> <span class="p">,</span> <span class="s2">&quot;j&quot;</span> <span class="p">:</span> <span class="mi">4</span> <span class="p">,</span> <span class="s2">&quot;_id&quot;</span> <span class="p">:</span> <span class="n">ObjectId</span><span class="p">(</span><span class="s2">&quot;497cf87151712cf7758fbdc0&quot;</span><span class="p">)}</span>
<span class="p">{</span><span class="s2">&quot;x&quot;</span> <span class="p">:</span> <span class="mi">4</span> <span class="p">,</span> <span class="s2">&quot;j&quot;</span> <span class="p">:</span> <span class="mi">5</span> <span class="p">,</span> <span class="s2">&quot;_id&quot;</span> <span class="p">:</span> <span class="n">ObjectId</span><span class="p">(</span><span class="s2">&quot;497cf87151712cf7758fbdc1&quot;</span><span class="p">)}</span>
<span class="p">{</span><span class="s2">&quot;x&quot;</span> <span class="p">:</span> <span class="mi">4</span> <span class="p">,</span> <span class="s2">&quot;j&quot;</span> <span class="p">:</span> <span class="mi">6</span> <span class="p">,</span> <span class="s2">&quot;_id&quot;</span> <span class="p">:</span> <span class="n">ObjectId</span><span class="p">(</span><span class="s2">&quot;497cf87151712cf7758fbdc2&quot;</span><span class="p">)}</span>
<span class="p">{</span><span class="s2">&quot;x&quot;</span> <span class="p">:</span> <span class="mi">4</span> <span class="p">,</span> <span class="s2">&quot;j&quot;</span> <span class="p">:</span> <span class="mi">7</span> <span class="p">,</span> <span class="s2">&quot;_id&quot;</span> <span class="p">:</span> <span class="n">ObjectId</span><span class="p">(</span><span class="s2">&quot;497cf87151712cf7758fbdc3&quot;</span><span class="p">)}</span>
<span class="p">{</span><span class="s2">&quot;x&quot;</span> <span class="p">:</span> <span class="mi">4</span> <span class="p">,</span> <span class="s2">&quot;j&quot;</span> <span class="p">:</span> <span class="mi">8</span> <span class="p">,</span> <span class="s2">&quot;_id&quot;</span> <span class="p">:</span> <span class="n">ObjectId</span><span class="p">(</span><span class="s2">&quot;497cf87151712cf7758fbdc4&quot;</span><span class="p">)}</span>
<span class="p">{</span><span class="s2">&quot;x&quot;</span> <span class="p">:</span> <span class="mi">4</span> <span class="p">,</span> <span class="s2">&quot;j&quot;</span> <span class="p">:</span> <span class="mi">9</span> <span class="p">,</span> <span class="s2">&quot;_id&quot;</span> <span class="p">:</span> <span class="n">ObjectId</span><span class="p">(</span><span class="s2">&quot;497cf87151712cf7758fbdc5&quot;</span><span class="p">)}</span>
<span class="o">&gt;</span>
</code></pre></div>


<p>上面的例子显示了游标风格的迭代输出. hasNext() 函数告诉我们是否还有数据, 如果有则可以调用 next() 函数. 这里我们也用了自带的 tojson() 方法返回一个标准的 JSON 格式数据.</p>

<p>当我们使用的是 JavaScript shell, 可以用到JS的特性, forEach 就可以输出游标了. 下面的例子就是使用 forEach() 来循环输出:</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span></span><span class="o">&gt;</span> <span class="n">db</span><span class="o">.</span><span class="n">things</span><span class="o">.</span><span class="n">find</span><span class="p">()</span><span class="o">.</span><span class="n">forEach</span><span class="p">(</span> <span class="n">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="p">{</span> <span class="k">print</span><span class="p">(</span><span class="n">tojson</span><span class="p">(</span><span class="n">x</span><span class="p">));});</span>
<span class="p">{</span><span class="s2">&quot;name&quot;</span> <span class="p">:</span> <span class="s2">&quot;mongo&quot;</span> <span class="p">,</span> <span class="s2">&quot;_id&quot;</span> <span class="p">:</span> <span class="n">ObjectId</span><span class="p">(</span><span class="s2">&quot;497cf60751712cf7758fbdbb&quot;</span><span class="p">)}</span>
<span class="p">{</span><span class="s2">&quot;x&quot;</span> <span class="p">:</span> <span class="mi">3</span> <span class="p">,</span> <span class="s2">&quot;_id&quot;</span> <span class="p">:</span> <span class="n">ObjectId</span><span class="p">(</span><span class="s2">&quot;497cf61651712cf7758fbdbc&quot;</span><span class="p">)}</span>
<span class="p">{</span><span class="s2">&quot;x&quot;</span> <span class="p">:</span> <span class="mi">4</span> <span class="p">,</span> <span class="s2">&quot;j&quot;</span> <span class="p">:</span> <span class="mi">1</span> <span class="p">,</span> <span class="s2">&quot;_id&quot;</span> <span class="p">:</span> <span class="n">ObjectId</span><span class="p">(</span><span class="s2">&quot;497cf87151712cf7758fbdbd&quot;</span><span class="p">)}</span>
<span class="p">{</span><span class="s2">&quot;x&quot;</span> <span class="p">:</span> <span class="mi">4</span> <span class="p">,</span> <span class="s2">&quot;j&quot;</span> <span class="p">:</span> <span class="mi">2</span> <span class="p">,</span> <span class="s2">&quot;_id&quot;</span> <span class="p">:</span> <span class="n">ObjectId</span><span class="p">(</span><span class="s2">&quot;497cf87151712cf7758fbdbe&quot;</span><span class="p">)}</span>
<span class="p">{</span><span class="s2">&quot;x&quot;</span> <span class="p">:</span> <span class="mi">4</span> <span class="p">,</span> <span class="s2">&quot;j&quot;</span> <span class="p">:</span> <span class="mi">3</span> <span class="p">,</span> <span class="s2">&quot;_id&quot;</span> <span class="p">:</span> <span class="n">ObjectId</span><span class="p">(</span><span class="s2">&quot;497cf87151712cf7758fbdbf&quot;</span><span class="p">)}</span>
<span class="p">{</span><span class="s2">&quot;x&quot;</span> <span class="p">:</span> <span class="mi">4</span> <span class="p">,</span> <span class="s2">&quot;j&quot;</span> <span class="p">:</span> <span class="mi">4</span> <span class="p">,</span> <span class="s2">&quot;_id&quot;</span> <span class="p">:</span> <span class="n">ObjectId</span><span class="p">(</span><span class="s2">&quot;497cf87151712cf7758fbdc0&quot;</span><span class="p">)}</span>
<span class="p">{</span><span class="s2">&quot;x&quot;</span> <span class="p">:</span> <span class="mi">4</span> <span class="p">,</span> <span class="s2">&quot;j&quot;</span> <span class="p">:</span> <span class="mi">5</span> <span class="p">,</span> <span class="s2">&quot;_id&quot;</span> <span class="p">:</span> <span class="n">ObjectId</span><span class="p">(</span><span class="s2">&quot;497cf87151712cf7758fbdc1&quot;</span><span class="p">)}</span>
<span class="p">{</span><span class="s2">&quot;x&quot;</span> <span class="p">:</span> <span class="mi">4</span> <span class="p">,</span> <span class="s2">&quot;j&quot;</span> <span class="p">:</span> <span class="mi">6</span> <span class="p">,</span> <span class="s2">&quot;_id&quot;</span> <span class="p">:</span> <span class="n">ObjectId</span><span class="p">(</span><span class="s2">&quot;497cf87151712cf7758fbdc2&quot;</span><span class="p">)}</span>
<span class="p">{</span><span class="s2">&quot;x&quot;</span> <span class="p">:</span> <span class="mi">4</span> <span class="p">,</span> <span class="s2">&quot;j&quot;</span> <span class="p">:</span> <span class="mi">7</span> <span class="p">,</span> <span class="s2">&quot;_id&quot;</span> <span class="p">:</span> <span class="n">ObjectId</span><span class="p">(</span><span class="s2">&quot;497cf87151712cf7758fbdc3&quot;</span><span class="p">)}</span>
<span class="p">{</span><span class="s2">&quot;x&quot;</span> <span class="p">:</span> <span class="mi">4</span> <span class="p">,</span> <span class="s2">&quot;j&quot;</span> <span class="p">:</span> <span class="mi">8</span> <span class="p">,</span> <span class="s2">&quot;_id&quot;</span> <span class="p">:</span> <span class="n">ObjectId</span><span class="p">(</span><span class="s2">&quot;497cf87151712cf7758fbdc4&quot;</span><span class="p">)}</span>
<span class="p">{</span><span class="s2">&quot;x&quot;</span> <span class="p">:</span> <span class="mi">4</span> <span class="p">,</span> <span class="s2">&quot;j&quot;</span> <span class="p">:</span> <span class="mi">9</span> <span class="p">,</span> <span class="s2">&quot;_id&quot;</span> <span class="p">:</span> <span class="n">ObjectId</span><span class="p">(</span><span class="s2">&quot;497cf87151712cf7758fbdc5&quot;</span><span class="p">)}</span>
<span class="o">&gt;</span>
</code></pre></div>


<p>forEach() 必须定义一个函数供每个游标元素调用.</p>

<p>在 mongo shell 里, 我们也可以把游标当作数组来用 :</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span></span><span class="o">&gt;</span> <span class="n">var</span> <span class="n">cursor</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">things</span><span class="o">.</span><span class="n">find</span><span class="p">();</span>
<span class="o">&gt;</span> <span class="k">print</span> <span class="p">(</span><span class="n">tojson</span><span class="p">(</span><span class="n">cursor</span><span class="p">[</span><span class="mi">4</span><span class="p">]));</span>
<span class="p">{</span><span class="s2">&quot;x&quot;</span> <span class="p">:</span> <span class="mi">4</span> <span class="p">,</span> <span class="s2">&quot;j&quot;</span> <span class="p">:</span> <span class="mi">3</span> <span class="p">,</span> <span class="s2">&quot;_id&quot;</span> <span class="p">:</span> <span class="n">ObjectId</span><span class="p">(</span><span class="s2">&quot;497cf87151712cf7758fbdbf&quot;</span><span class="p">)}</span>
</code></pre></div>


<p>使用游标时候请注意占用内存的问题, 特别是很大的游标对象, 有可能会内存溢出. 所以应该用迭代的方式来输出.</p>

<p>下面的示例则是把游标转换成真实的数组类型:</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span></span><span class="o">&gt;</span> <span class="n">var</span> <span class="n">arr</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">things</span><span class="o">.</span><span class="n">find</span><span class="p">()</span><span class="o">.</span><span class="n">toArray</span><span class="p">();</span>
<span class="o">&gt;</span> <span class="n">arr</span><span class="p">[</span><span class="mi">5</span><span class="p">];</span>
<span class="p">{</span><span class="s2">&quot;x&quot;</span> <span class="p">:</span> <span class="mi">4</span> <span class="p">,</span> <span class="s2">&quot;j&quot;</span> <span class="p">:</span> <span class="mi">4</span> <span class="p">,</span> <span class="s2">&quot;_id&quot;</span> <span class="p">:</span> <span class="n">ObjectId</span><span class="p">(</span><span class="s2">&quot;497cf87151712cf7758fbdc0&quot;</span><span class="p">)}</span>
</code></pre></div>


<p>请注意这些特性只是在 mongo shell 里使用, 而不是所有的其他应用程序驱动都支持.</p>

<p>MongoDB 游标对象不是没有快照 - 如果有其他用户在集合里第一次或者最后一次调用 next(), 你可以得不到游标里的数据. 所以要明确的锁定你要查询的游标.</p>

<p>指定条件的查询</p>

<p>到这里我们已经知道怎么从游标里实现一个查询并返回数据对象, 下面就来看看怎么根据指定的条件来查询.</p>

<p>下面的示例就是说明如何执行一个类似SQL的查询, 并演示了怎么在 MongoDB 里实现. 这是在 MongoDB shell 里查询, 当然你也可以用其他的应用驱动或者语言来实现:</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span></span><span class="n">SELECT</span> <span class="o">*</span> <span class="n">FROM</span> <span class="n">things</span> <span class="n">WHERE</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;mongo&quot;</span>
</code></pre></div>


<div class="highlight"><pre><code class="language-python" data-lang="python"><span></span><span class="o">&gt;</span> <span class="n">db</span><span class="o">.</span><span class="n">things</span><span class="o">.</span><span class="n">find</span><span class="p">({</span><span class="n">name</span><span class="p">:</span><span class="s2">&quot;mongo&quot;</span><span class="p">})</span><span class="o">.</span><span class="n">forEach</span><span class="p">(</span><span class="n">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="p">{</span> <span class="k">print</span><span class="p">(</span><span class="n">tojson</span><span class="p">(</span><span class="n">x</span><span class="p">));});</span>
<span class="p">{</span><span class="s2">&quot;name&quot;</span> <span class="p">:</span> <span class="s2">&quot;mongo&quot;</span> <span class="p">,</span> <span class="s2">&quot;_id&quot;</span> <span class="p">:</span> <span class="n">ObjectId</span><span class="p">(</span><span class="s2">&quot;497cf60751712cf7758fbdbb&quot;</span><span class="p">)}</span>
<span class="o">&gt;</span>
</code></pre></div>


<div class="highlight"><pre><code class="language-python" data-lang="python"><span></span><span class="n">SELECT</span> <span class="o">*</span> <span class="n">FROM</span> <span class="n">things</span> <span class="n">WHERE</span> <span class="n">x</span><span class="o">=</span><span class="mi">4</span>
</code></pre></div>


<div class="highlight"><pre><code class="language-python" data-lang="python"><span></span><span class="o">&gt;</span> <span class="n">db</span><span class="o">.</span><span class="n">things</span><span class="o">.</span><span class="n">find</span><span class="p">({</span><span class="n">x</span><span class="p">:</span><span class="mi">4</span><span class="p">})</span><span class="o">.</span><span class="n">forEach</span><span class="p">(</span><span class="n">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="p">{</span> <span class="k">print</span><span class="p">(</span><span class="n">tojson</span><span class="p">(</span><span class="n">x</span><span class="p">));});</span>
<span class="p">{</span><span class="s2">&quot;x&quot;</span> <span class="p">:</span> <span class="mi">4</span> <span class="p">,</span> <span class="s2">&quot;j&quot;</span> <span class="p">:</span> <span class="mi">1</span> <span class="p">,</span> <span class="s2">&quot;_id&quot;</span> <span class="p">:</span> <span class="n">ObjectId</span><span class="p">(</span><span class="s2">&quot;497cf87151712cf7758fbdbd&quot;</span><span class="p">)}</span>
<span class="p">{</span><span class="s2">&quot;x&quot;</span> <span class="p">:</span> <span class="mi">4</span> <span class="p">,</span> <span class="s2">&quot;j&quot;</span> <span class="p">:</span> <span class="mi">2</span> <span class="p">,</span> <span class="s2">&quot;_id&quot;</span> <span class="p">:</span> <span class="n">ObjectId</span><span class="p">(</span><span class="s2">&quot;497cf87151712cf7758fbdbe&quot;</span><span class="p">)}</span>
<span class="p">{</span><span class="s2">&quot;x&quot;</span> <span class="p">:</span> <span class="mi">4</span> <span class="p">,</span> <span class="s2">&quot;j&quot;</span> <span class="p">:</span> <span class="mi">3</span> <span class="p">,</span> <span class="s2">&quot;_id&quot;</span> <span class="p">:</span> <span class="n">ObjectId</span><span class="p">(</span><span class="s2">&quot;497cf87151712cf7758fbdbf&quot;</span><span class="p">)}</span>
<span class="p">{</span><span class="s2">&quot;x&quot;</span> <span class="p">:</span> <span class="mi">4</span> <span class="p">,</span> <span class="s2">&quot;j&quot;</span> <span class="p">:</span> <span class="mi">4</span> <span class="p">,</span> <span class="s2">&quot;_id&quot;</span> <span class="p">:</span> <span class="n">ObjectId</span><span class="p">(</span><span class="s2">&quot;497cf87151712cf7758fbdc0&quot;</span><span class="p">)}</span>
<span class="p">{</span><span class="s2">&quot;x&quot;</span> <span class="p">:</span> <span class="mi">4</span> <span class="p">,</span> <span class="s2">&quot;j&quot;</span> <span class="p">:</span> <span class="mi">5</span> <span class="p">,</span> <span class="s2">&quot;_id&quot;</span> <span class="p">:</span> <span class="n">ObjectId</span><span class="p">(</span><span class="s2">&quot;497cf87151712cf7758fbdc1&quot;</span><span class="p">)}</span>
<span class="p">{</span><span class="s2">&quot;x&quot;</span> <span class="p">:</span> <span class="mi">4</span> <span class="p">,</span> <span class="s2">&quot;j&quot;</span> <span class="p">:</span> <span class="mi">6</span> <span class="p">,</span> <span class="s2">&quot;_id&quot;</span> <span class="p">:</span> <span class="n">ObjectId</span><span class="p">(</span><span class="s2">&quot;497cf87151712cf7758fbdc2&quot;</span><span class="p">)}</span>
<span class="p">{</span><span class="s2">&quot;x&quot;</span> <span class="p">:</span> <span class="mi">4</span> <span class="p">,</span> <span class="s2">&quot;j&quot;</span> <span class="p">:</span> <span class="mi">7</span> <span class="p">,</span> <span class="s2">&quot;_id&quot;</span> <span class="p">:</span> <span class="n">ObjectId</span><span class="p">(</span><span class="s2">&quot;497cf87151712cf7758fbdc3&quot;</span><span class="p">)}</span>
<span class="p">{</span><span class="s2">&quot;x&quot;</span> <span class="p">:</span> <span class="mi">4</span> <span class="p">,</span> <span class="s2">&quot;j&quot;</span> <span class="p">:</span> <span class="mi">8</span> <span class="p">,</span> <span class="s2">&quot;_id&quot;</span> <span class="p">:</span> <span class="n">ObjectId</span><span class="p">(</span><span class="s2">&quot;497cf87151712cf7758fbdc4&quot;</span><span class="p">)}</span>
<span class="p">{</span><span class="s2">&quot;x&quot;</span> <span class="p">:</span> <span class="mi">4</span> <span class="p">,</span> <span class="s2">&quot;j&quot;</span> <span class="p">:</span> <span class="mi">9</span> <span class="p">,</span> <span class="s2">&quot;_id&quot;</span> <span class="p">:</span> <span class="n">ObjectId</span><span class="p">(</span><span class="s2">&quot;497cf87151712cf7758fbdc5&quot;</span><span class="p">)}</span>
<span class="o">&gt;</span>
</code></pre></div>


<p>查询条件是 { a:A, b:B, &hellip; } 类似 &ldquo;where a==A and b==B and &hellip;&rdquo;, 更多的查询方式可以参考 Mongo 开发教程部分.</p>

<p>上面显示的是所有的元素, 当然我们也可以返回特定的元素, 类似于返回表里某字段的值, 只需要在 find({x:4}) 里指定元素的名字, 比如 j:</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span></span><span class="n">SELECT</span> <span class="n">j</span> <span class="n">FROM</span> <span class="n">things</span> <span class="n">WHERE</span> <span class="n">x</span><span class="o">=</span><span class="mi">4</span>
</code></pre></div>


<div class="highlight"><pre><code class="language-python" data-lang="python"><span></span><span class="o">&gt;</span> <span class="n">db</span><span class="o">.</span><span class="n">things</span><span class="o">.</span><span class="n">find</span><span class="p">({</span><span class="n">x</span><span class="p">:</span><span class="mi">4</span><span class="p">},</span> <span class="p">{</span><span class="n">j</span><span class="p">:</span><span class="n">true</span><span class="p">})</span><span class="o">.</span><span class="n">forEach</span><span class="p">(</span><span class="n">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="p">{</span> <span class="k">print</span><span class="p">(</span><span class="n">tojson</span><span class="p">(</span><span class="n">x</span><span class="p">));});</span>
<span class="p">{</span><span class="s2">&quot;j&quot;</span> <span class="p">:</span> <span class="mi">1</span> <span class="p">,</span> <span class="s2">&quot;_id&quot;</span> <span class="p">:</span> <span class="n">ObjectId</span><span class="p">(</span><span class="s2">&quot;497cf87151712cf7758fbdbd&quot;</span><span class="p">)}</span>
<span class="p">{</span><span class="s2">&quot;j&quot;</span> <span class="p">:</span> <span class="mi">2</span> <span class="p">,</span> <span class="s2">&quot;_id&quot;</span> <span class="p">:</span> <span class="n">ObjectId</span><span class="p">(</span><span class="s2">&quot;497cf87151712cf7758fbdbe&quot;</span><span class="p">)}</span>
<span class="p">{</span><span class="s2">&quot;j&quot;</span> <span class="p">:</span> <span class="mi">3</span> <span class="p">,</span> <span class="s2">&quot;_id&quot;</span> <span class="p">:</span> <span class="n">ObjectId</span><span class="p">(</span><span class="s2">&quot;497cf87151712cf7758fbdbf&quot;</span><span class="p">)}</span>
<span class="p">{</span><span class="s2">&quot;j&quot;</span> <span class="p">:</span> <span class="mi">4</span> <span class="p">,</span> <span class="s2">&quot;_id&quot;</span> <span class="p">:</span> <span class="n">ObjectId</span><span class="p">(</span><span class="s2">&quot;497cf87151712cf7758fbdc0&quot;</span><span class="p">)}</span>
<span class="p">{</span><span class="s2">&quot;j&quot;</span> <span class="p">:</span> <span class="mi">5</span> <span class="p">,</span> <span class="s2">&quot;_id&quot;</span> <span class="p">:</span> <span class="n">ObjectId</span><span class="p">(</span><span class="s2">&quot;497cf87151712cf7758fbdc1&quot;</span><span class="p">)}</span>
<span class="p">{</span><span class="s2">&quot;j&quot;</span> <span class="p">:</span> <span class="mi">6</span> <span class="p">,</span> <span class="s2">&quot;_id&quot;</span> <span class="p">:</span> <span class="n">ObjectId</span><span class="p">(</span><span class="s2">&quot;497cf87151712cf7758fbdc2&quot;</span><span class="p">)}</span>
<span class="p">{</span><span class="s2">&quot;j&quot;</span> <span class="p">:</span> <span class="mi">7</span> <span class="p">,</span> <span class="s2">&quot;_id&quot;</span> <span class="p">:</span> <span class="n">ObjectId</span><span class="p">(</span><span class="s2">&quot;497cf87151712cf7758fbdc3&quot;</span><span class="p">)}</span>
<span class="p">{</span><span class="s2">&quot;j&quot;</span> <span class="p">:</span> <span class="mi">8</span> <span class="p">,</span> <span class="s2">&quot;_id&quot;</span> <span class="p">:</span> <span class="n">ObjectId</span><span class="p">(</span><span class="s2">&quot;497cf87151712cf7758fbdc4&quot;</span><span class="p">)}</span>
<span class="p">{</span><span class="s2">&quot;j&quot;</span> <span class="p">:</span> <span class="mi">9</span> <span class="p">,</span> <span class="s2">&quot;_id&quot;</span> <span class="p">:</span> <span class="n">ObjectId</span><span class="p">(</span><span class="s2">&quot;497cf87151712cf7758fbdc5&quot;</span><span class="p">)}</span>
<span class="o">&gt;</span>
</code></pre></div>


<p>请注意 &ldquo;_id&rdquo; 元素会一直被返回.</p>

<p>findOne() - 语法糖</p>

<p>为了方便, mongo shell (其他驱动) 避免游标的可能带来的开销, 提供一个findOne() 函数. 这个函数和 find() 参数一样, 不过他返回游标里第一条数据, 或者返回 null 空数据库.</p>

<p>作为一个例子, name==&lsquo;mongo&rsquo; 可以用很多方法来实现, 可以用 next() 来循环游标(需要校验是否为null), 或者当做数组返回第一个元素.</p>

<p>但是用 findOne() 方法则更简单和高效:</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span></span><span class="o">&gt;</span> <span class="n">var</span> <span class="n">mongo</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">things</span><span class="o">.</span><span class="n">findOne</span><span class="p">({</span><span class="n">name</span><span class="p">:</span><span class="s2">&quot;mongo&quot;</span><span class="p">});</span>
<span class="o">&gt;</span> <span class="k">print</span><span class="p">(</span><span class="n">tojson</span><span class="p">(</span><span class="n">mongo</span><span class="p">));</span>
<span class="p">{</span><span class="s2">&quot;name&quot;</span> <span class="p">:</span> <span class="s2">&quot;mongo&quot;</span> <span class="p">,</span> <span class="s2">&quot;_id&quot;</span> <span class="p">:</span> <span class="n">ObjectId</span><span class="p">(</span><span class="s2">&quot;497cf60751712cf7758fbdbb&quot;</span><span class="p">)}</span>
<span class="o">&gt;</span>
</code></pre></div>


<p>findOne 方法更跟 find({name:&ldquo;mongo&rdquo;}).limit(1) 一样.</p>

<p>limit() 查询</p>

<p>你可以需要限制结果集的长度, 可以调用 limit 方法.</p>

<p>这是强烈推荐高性能的原因, 通过限制条数来减少网络传输, 例如:</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span></span><span class="o">&gt;</span> <span class="n">db</span><span class="o">.</span><span class="n">things</span><span class="o">.</span><span class="n">find</span><span class="p">()</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>
<span class="ow">in</span> <span class="n">cursor</span> <span class="k">for</span> <span class="p">:</span> <span class="n">DBQuery</span><span class="p">:</span> <span class="n">example</span><span class="o">.</span><span class="n">things</span> <span class="o">-&gt;</span>
<span class="p">{</span><span class="s2">&quot;name&quot;</span> <span class="p">:</span> <span class="s2">&quot;mongo&quot;</span> <span class="p">,</span> <span class="s2">&quot;_id&quot;</span> <span class="p">:</span> <span class="n">ObjectId</span><span class="p">(</span><span class="s2">&quot;497cf60751712cf7758fbdbb&quot;</span><span class="p">)}</span>
<span class="p">{</span><span class="s2">&quot;x&quot;</span> <span class="p">:</span> <span class="mi">3</span> <span class="p">,</span> <span class="s2">&quot;_id&quot;</span> <span class="p">:</span> <span class="n">ObjectId</span><span class="p">(</span><span class="s2">&quot;497cf61651712cf7758fbdbc&quot;</span><span class="p">)}</span>
<span class="p">{</span><span class="s2">&quot;x&quot;</span> <span class="p">:</span> <span class="mi">4</span> <span class="p">,</span> <span class="s2">&quot;j&quot;</span> <span class="p">:</span> <span class="mi">1</span> <span class="p">,</span> <span class="s2">&quot;_id&quot;</span> <span class="p">:</span> <span class="n">ObjectId</span><span class="p">(</span><span class="s2">&quot;497cf87151712cf7758fbdbd&quot;</span><span class="p">)}</span>
<span class="o">&gt;</span>
</code></pre></div>


<p>更多帮助</p>

<p>除非了一般的 help 之外, 你还可以查询 help 数据库和db.whatever 来查询具体的说明.</p>

<p>如果你对一个函数要做什么, 你可以不输入 {{()}} 这些结束的括号则可以输出实现的源码, 例如:</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span></span><span class="o">&gt;</span> <span class="n">db</span><span class="o">.</span><span class="n">foo</span><span class="o">.</span><span class="n">insert</span>
<span class="n">function</span> <span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">_allow_dot</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="err">!</span><span class="n">obj</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">throw</span> <span class="s2">&quot;no object passed to insert!&quot;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="err">!</span><span class="n">_allow_dot</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">this</span><span class="o">.</span><span class="n">_validateForStorage</span><span class="p">(</span><span class="n">obj</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">this</span><span class="o">.</span><span class="n">_mongo</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">this</span><span class="o">.</span><span class="n">_fullName</span><span class="p">,</span> <span class="n">obj</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>


<p>mongo 是一个完整的 JavaScript shell程序, 所以在 shell 里完全可以私用JS的方法、类、语法. 此外, MongoDB 定义很多自己的类和全局变量 (比如 db). 这里可以查看完整的API说明 <a href="http://api.mongodb.org/js/">http://api.mongodb.org/js/</a>.</p>

<p>接下来</p>

<p>看完这篇教程后下一步则看MongoDB更详细的文档 <a href="http://www.mongodb.org/display/DOCS/Manual">http://www.mongodb.org/display/DOCS/Manual</a></p>

</article>

</main>
		<footer id="footer">
			<section id="footer-message">&copy; smallfish&#39;s blog. All rights reserved. Powered by <a href="http://gohugo.io" target="_blank">Hugo</a>. <a href="https://github.com/kathyqian/crisp-ghost-theme" target="_blank">Crisp</a> theme by <a href="http://kathyqian.com" target="_blank">Kathy Qian</a>.</section>
		</footer>

    <script>
      (function(c,f){asyncLoader=function(i,h){i.foreach(function(k,j){e(j,d(j),h)});if(typeof h.callback=="function"){var g=setInterval(function(){if(f.readyState==="complete"){clearInterval(g);h.callback()}},10)}};var d=function(g){var h=g.split(".");return h[h.length-1]},e=function(h,i,g){switch(i){case"js":a(h,g);break;case"css":b(h);break;default:break}},a=function(i,h){var g=document.createElement("script");g.type="text/javascript";g.async=true;g.src=i;document.getElementsByTagName("head")[0].appendChild(g)},b=function(g){var h=document.createElement("link");h.type="text/css";h.rel="stylesheet";h.href=g;document.getElementsByTagName("head")[0].appendChild(h)};Array.prototype.foreach=function(h){for(var g=0;g<this.length;g++){h(g,this[g])}}})(this,document);

      var WebFontConfig={google:{families:["Open Sans:300italic,700italic,300,700","Bree+Serif"]}};
      asyncLoader([
        "//netdna.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.css",
        "//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js",
        "//cdnjs.cloudflare.com/ajax/libs/webfont/1.5.16/webfontloader.js",
        "//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.5/highlight.min.js"
      ],{
        callback:function(){
          asyncLoader([
            "http:\/\/chenxiaoyu.org\/css/rrssb.css",
            "http:\/\/chenxiaoyu.org\/js/gist.min.js", 
            "http:\/\/chenxiaoyu.org\/js/rrssb.min.js",
            "//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.5/styles/default.min.css"
          ], { callback:function() {
              hljs.initHighlighting();
          }});
        }
      });
    </script>
	
	</body>
</html>
